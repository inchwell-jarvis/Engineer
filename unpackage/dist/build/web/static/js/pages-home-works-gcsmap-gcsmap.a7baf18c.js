(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-home-works-gcsmap-gcsmap"],{"40b6":function(t,e,a){var s=a("b34f");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var n=a("967d").default;n("ba26dcdc",s,!0,{sourceMap:!1,shadowMode:!1})},"4d161":function(t,e,a){"use strict";a("6a54");var s=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(a("2634")),r=s(a("2fdc"));a("aa9c"),a("64aa");var o={data:function(){return{latitude:"39.519219",longitude:"116.698215",markers:[],polylines:[],gcsdata:[],gcsdataB:[],data:[],android_gcs:"../../../../static/img/android_gcs.png",android_qyjl:"../../../../static/img/android_qyjl.png",ios_gcs:"../../../../static/img/ios_gcs.png",ios_qyjl:"../../../../static/img/ios_qyjl.png",areaS:[],scale:10,itemEnginnerId:"",arrowIconPathUrl:"../../../../static/img/traffic_texture_darkred.png",status:"loading",stateNumber:60,loadText:{loadmore:"轻轻上拉",loading:"",nomore:"数据为空"},timer:null}},created:function(){this.initmapsGCS(),this.initGetArea()},onReady:function(){this.getlocal()},methods:{SelectTrajectory:function(t){var e=this,a={method:"get",url:this.$store.state.url+"System/SelectTrajectory",data:{employeeId:t}};this.$httpnone(a).then((function(t){var a=t.Data.StatDtos;if(console.log(a),null==a)return!1;for(var s=[],n=0;n<a.length;n++)s.push({latitude:a[n].Key,longitude:a[n].Describe});var r=0;r="ios"==uni.getSystemInfoSync().platform?3:10,e.polylines=[{points:s,dottedLine:!0,arrowLine:!0,arrowIconPath:"../../../../static/img/traffic_texture_darkred.png",width:r,color:"#ff5500"}]}))},TabGCSIP:function(t,e){this.scale=14,this.longitude=t.Longitude,this.latitude=t.Latitude,this.gcsdata[e].Conter=!this.gcsdata[e].Conter;var a=this.gcsdata;this.gcsdata=[],this.gcsdata=a,this.itemEnginnerId!=t.EnginnerId&&(this.scale=16,this.SelectTrajectory(t.EnginnerId),this.itemEnginnerId=t.EnginnerId)},initGetArea:function(){var t=this,e={url:this.$store.state.url+"System/GetArea",method:"get"};this.$httpnone(e).then((function(e){t.areaS=e.Data,console.log(t.areaS),t.selector=[];for(var a=0;a<t.areaS.length;a++)t.selector.push(t.areaS[a].Value)}))},initmapsGCSCS:function(){console.log(this.status),"loading"!=this.status&&0!=this.status&&(uni.showToast({title:"正在重试 ~~~",icon:"none"}),this.initmapsGCS())},initmapsGCS:function(){var t=this;console.log("获取了工程师定位！******************************************************");var e={url:this.$store.state.url+"System/SelectMapCoordinate",method:"GET"};clearInterval(this.timer),this.timer=setInterval((function(){t.loadText.loading="正在获取定位轨迹 ~ "+t.stateNumber+"秒后重试！",t.stateNumber--,0==t.stateNumber&&(clearInterval(t.timer),t.initmapsGCS(),t.stateNumber=60)}),1e3),this.$httpnone(e).then((function(e){var a=e.Data.Dtos,s=e.Data.Dtos.length;console.log(s),0==s?t.status="nomore":(clearInterval(t.timer),t.status=!1);for(var n=0;n<a.length;n++){"ios"==uni.getSystemInfoSync().platform?1==a[n].Role?a[n]["Roles"]=t.ios_qyjl:a[n]["Roles"]=t.ios_gcs:1==a[n].Role?a[n]["Roles"]=t.android_qyjl:a[n]["Roles"]=t.android_gcs,a[n]["title"]=!0;var r=a[n].ServingOrderType;0==r&&(a[n]["types"]="空闲",a[n]["color"]=t.stylethe),1==r&&(a[n]["types"]="保养途中",a[n]["color"]=t.styletwe),2==r&&(a[n]["types"]="维修途中",a[n]["color"]=t.styletwe),3==r&&(a[n]["types"]="正在保养",a[n]["color"]=t.styleone),4==r&&(a[n]["types"]="正在维修",a[n]["color"]=t.styleone),5==r&&(a[n]["types"]="打卡",a[n]["color"]=t.stylethe),6==r&&(a[n]["types"]="安装在途",a[n]["color"]=t.styletwe),7==r&&(a[n]["types"]="正在安装",a[n]["color"]=t.styleone)}t.gcsdata=t.SortGcs(a);for(var o=0;o<t.gcsdata.length;o++)t.gcsdata[o]["Conter"]=!1;t.gcsdataB=t.SortGcs(a),t.markers=[];for(var i=0;i<t.gcsdataB.length;i++){var l={id:"sdfsfsdfsdfsd2",latitude:t.gcsdataB[i].Latitude,longitude:t.gcsdataB[i].Longitude,iconPath:"../../../../static/img/gcs_mini.png",width:"10",label:{content:t.gcsdataB[i].Enginner,color:"#F76350",anchorX:0,anchorY:-80,bgColor:"#fff",padding:5,borderWidth:1,borderColor:"#D84C29",textAlign:"right"},callout:{content:t.gcsdataB[i].Detail,color:"#F76350",fontSize:12,borderRadius:5}};l.iconPath=t.gcsdataB[i].Roles,t.markers.push(l)}})).catch((function(e){console.log(e),clearInterval(t.timer),t.status="nomore",t.loadText.nomore="请求失败！点击重试！"}))},getlocal:function(){var t=this;return(0,r.default)((0,n.default)().mark((function e(){var a,s,r;return(0,n.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,s=uni.createMapContext("maps",t).$getAppMap(),s.showUserLocation(!0),e.next=5,t.getLocation();case 5:r=e.sent,console.log(r),a.longitude=r.longitude,a.latitude=r.latitude;case 9:case"end":return e.stop()}}),e)})))()},GetGcsIp:function(){var t=this,e={url:this.$store.state.url+"api/System/SelectMapCoordinate",method:"GET",header:this.$store.state.token};this.$http(e).then((function(e){console.log(t.Data)}))},SortGcs:function(t){for(var e=[],a=[],s=0;s<t.length;s++){var n=t[s];1==n.Role?e.push(n):a.push(n)}for(var r=[[],[],[],[],[],[],[],[]],o=0;o<e.length;o++){var i=e[o];"正在安装"==i.Message&&r[0].push(i),"保养在途"==i.Message&&r[1].push(i),"维修在途"==i.Message&&r[2].push(i),"正在保养"==i.Message&&r[3].push(i),"正在维修"==i.Message&&r[4].push(i),"打卡"==i.Message&&r[5].push(i),"安装在途"==i.Message&&r[6].push(i),"空闲"==i.Message&&r[7].push(i)}for(var l=[],c=0;c<r.length;c++){var d=r[c];if(0!=d.length)for(var u=0;u<d.length;u++){var h=d[u];l.push(h)}}for(var g=[[],[],[],[],[],[],[],[]],p=0;p<a.length;p++){var f=a[p];"正在安装"==f.Message&&g[0].push(f),"保养在途"==f.Message&&g[1].push(f),"维修在途"==f.Message&&g[2].push(f),"正在保养"==f.Message&&g[3].push(f),"正在维修"==f.Message&&g[4].push(f),"打卡"==f.Message&&g[5].push(f),"安装在途"==f.Message&&g[6].push(f),"空闲"==f.Message&&g[7].push(f)}for(var v=[],m=0;m<g.length;m++){var M=g[m];if(0!=M.length)for(var b=0;b<M.length;b++){var y=M[b];v.push(y)}}for(var S=l,w=0;w<v.length;w++){var _=v[w];S.push(_)}return this.data=S,S},bd_encrypt:function(t,e){var a=3e3*Math.PI/180,s=t,n=e,r=Math.sqrt(s*s+n*n)+2e-5*Math.sin(n*a),o=Math.atan2(n,s)+3e-6*Math.cos(s*a),i=r*Math.cos(o)+.0065,l=r*Math.sin(o)+.006;return[i,l]},wgs84togcj02:function(t,e){var a=Number(t),s=Number(e),n=52.35987755982988,r=6378245,o=.006693421622965943,i=3.141592653589793;if(this.out_of_china(a,s))return[a,s];var l=this.transformlat(a-105,s-35),c=this.transformlng(a-105,s-35),d=s/180*i,u=Math.sin(d);u=1-o*u*u;var h=Math.sqrt(u);l=180*l/(r*(1-o)/(u*h)*i),c=180*c/(r/h*Math.cos(d)*i);var g=s+l,p=a+c,f=p,v=g,m=Math.sqrt(f*f+v*v)+2e-5*Math.sin(v*n),M=Math.atan2(v,f)+3e-6*Math.cos(f*n),b=m*Math.cos(M)+.0065,y=m*Math.sin(M)+.006;return[b,y]},gcj02tobd09:function(t,e){var a=52.35987755982988,s=t.split(".")[0]+"."+t.split(".")[1],n=e.split(".")[0]+"."+e.split(".")[1],r=Math.sqrt(s*s+n*n)+2e-5*Math.sin(n*a),o=Math.atan2(n,s)+3e-6*Math.cos(s*a),i=r*Math.cos(o)+.0065,l=r*Math.sin(o)+.006;return[i,l]},out_of_china:function(t,e){return t<72.004||t>137.8347||e<.8293||e>55.8271||!1},transformlat:function(t,e){var a=Number(t),s=Number(e),n=3.141592653589793,r=2*a-100+3*s+.2*s*s+.1*a*s+.2*Math.sqrt(Math.abs(a));return r+=2*(20*Math.sin(6*a*n)+20*Math.sin(2*a*n))/3,r+=2*(20*Math.sin(s*n)+40*Math.sin(s/3*n))/3,r+=2*(160*Math.sin(s/12*n)+320*Math.sin(s*n/30))/3,r},transformlng:function(t,e){var a=Number(t),s=Number(e),n=3.141592653589793,r=300+a+2*s+.1*a*a+.1*a*s+.1*Math.sqrt(Math.abs(a));return r+=2*(20*Math.sin(6*a*n)+20*Math.sin(2*a*n))/3,r+=2*(20*Math.sin(a*n)+40*Math.sin(a/3*n))/3,r+=2*(150*Math.sin(a/12*n)+300*Math.sin(a/30*n))/3,r}}};e.default=o},"672d":function(t,e,a){"use strict";a.r(e);var s=a("ba3b"),n=a("fd7a");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("83c3");var o=a("828b"),i=Object(o["a"])(n["default"],s["b"],s["c"],!1,null,"de59eda8",null,!1,s["a"],void 0);e["default"]=i.exports},"83c3":function(t,e,a){"use strict";var s=a("40b6"),n=a.n(s);n.a},b34f:function(t,e,a){var s=a("c86c");e=s(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.con[data-v-de59eda8]{width:100%;height:100%}.BotttomView[data-v-de59eda8]{width:100%;height:40%;overflow:auto;padding:10px;border-top:5px solid #ccc;box-sizing:border-box}.BotttomView .GCSBUTBox[data-v-de59eda8]{width:90%;border-radius:12px;margin:auto;margin-bottom:3px}.BotttomView .GCSBUTBox .GCSBUT[data-v-de59eda8]{height:40px;border-radius:12px;line-height:40px;background-color:#007aff;color:#fff;padding-left:20px;overflow:hidden}.BotttomView .GCSBUTBox .GCSBUT .butIP[data-v-de59eda8]{width:100px;height:100%;float:right;background-color:#5af;text-align:center;line-height:50px}.BotttomView .GCSBUTBox .Cnoter[data-v-de59eda8]{width:100%;min-height:50px;padding:20px;box-sizing:border-box}',""]),t.exports=e},ba3b:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return s}));var s={uLoadmore:a("73cd").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"con"},[a("v-uni-view",{staticClass:"IPmap",staticStyle:{width:"100%",height:"60%"}},[a("v-uni-map",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"maps",latitude:t.latitude,longitude:t.longitude,"enable-overlooking":!0,markers:t.markers,polyline:t.polylines,scale:t.scale}})],1),a("v-uni-view",{staticClass:"BotttomView",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.initmapsGCSCS()}}},[0!=t.status?a("u-loadmore",{attrs:{status:t.status,"load-text":t.loadText}}):t._e(),t._l(t.gcsdata,(function(e,s){return a("v-uni-view",{staticClass:"GCSBUTBox"},[a("v-uni-view",{staticClass:"GCSBUT",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.TabGCSIP(e,s)}}},[t._v(t._s(e.Enginner)),a("v-uni-view",{staticClass:"butIP",style:{color:"空闲"==e.types?"red":"#00ff00"}},[t._v(t._s(e.types))])],1),e.Conter?a("v-uni-view",{staticClass:"Cnoter"},[a("v-uni-text",{staticStyle:{"font-size":"12px","font-weight":"bold"}},[t._v(t._s(e.Detail))]),t._l(e.Orders,(function(e){return a("p",{staticStyle:{"font-size":"10px"}},[a("span",[t._v(t._s(e.OrderState+" - - "))]),a("span",[t._v(t._s((1==e.WorkType?"保养":2==e.WorkType?"维修":"安装")+" - - "))]),t._v(t._s(e.CusFullName))])}))],2):t._e()],1)}))],2)],1)},r=[]},fd7a:function(t,e,a){"use strict";a.r(e);var s=a("4d161"),n=a.n(s);for(var r in s)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(r);e["default"]=n.a}}]);